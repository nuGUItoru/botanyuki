<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>一つ、また一つ</title>
  <style>
    .counter {
      border: 1px solid #ccc;
      padding: 5px;
      margin: 2px;
      display: inline-block;
      text-align: center;
    }
    .counter .value {
      font-size: 2em;
      margin-bottom: 10px;
    }
    .value {
      border: 1px solid #ccc;
      display: inline-block;
      width: 3em;
      text-align: right;
      margin: 5px;
    }
    button {
      margin: 2px;
      padding: 5px 10px;
    }
  </style>
</head>
<body>
  <h1>カウンター</h1>
  <!-- カウンターを格納するコンテナ -->
  <div id="counters"></div>
  
  <script>
    // 複数カウンターの初期値の設定
    const countersData = [
      { id: "counter1", value: 0 },
      { id: "counter2", value: 0 },
      { id: "counter3", value: 0 },
      { id: "counter4", value: 0 },
      { id: "counter5", value: 0 },
      { id: "counter6", value: 0 },
      { id: "counter7", value: 0 },
      { id: "counter8", value: 0 }
    ];

    // 起動時に保存されているカウンター値を読み込む
    //window.onload = initWindows;
    
    // カウンター要素を生成する関数
    function createCounter(counter) {
      // カウンターの親要素
      const container = document.createElement('div');
      container.className = 'counter';
      container.id = counter.id;

      // 現在のカウンターの値を表示する要素
      const display = document.createElement('span');
      display.className = 'value';
      display.textContent = counter.value;

      // 「+」ボタン（加算）
      const addButton = document.createElement('button');
      addButton.textContent = '+';
      addButton.addEventListener('click', function () {
        // 値をインクリメントして表示を更新
        counter.value++;
        display.textContent = counter.value;
        saveCounters();  // 保存
      });

      // 「-」ボタン（減算）
      const subtractButton = document.createElement('button');
      subtractButton.textContent = '-';
      subtractButton.addEventListener('click', function () {
        // 値をデクリメントして表示を更新
        counter.value--;
        display.textContent = counter.value;
        saveCounters();  // 保存
      });

      // 「クリア」ボタン（値の初期化）
      const clearButton = document.createElement('button');
      clearButton.textContent = 'クリア';
      clearButton.addEventListener('click', function () {
        // 値を 0 にして表示を更新
        counter.value = 0;
        display.textContent = counter.value;
        saveCounters();  // 保存
      });

      // 各要素をコンテナに追加
      container.appendChild(display);
      container.appendChild(addButton);
      container.appendChild(subtractButton);
      container.appendChild(clearButton);

      return container;
    }

    // カウンター値保存
    function saveCounters() {
      var countersContainer = document.getElementById('counters');
      countersData.forEach(function(counter) {
        var storageID = "OneByOne_" + counter.id;
        localStorage.setItem(storageID, counter.value);
        //localStorage.setItem(storageID, counter.value.toString());
      });
    }

    // カウンター値読込
    function loadCounters() {
      var countersContainer = document.getElementById('counters');
      countersData.forEach(function(counter) {
        var storageID = "OneByOne_" + counter.id;
        var countValue = localStorage.getItem(storageID);

        if(isNaN(countValue) == true)
        {
          countValue = 0;
        }
        counter.value = countValue;
      });
    }

    // カウンター値読込
    loadCounters();

    // ページ内の counters コンテナに各カウンター要素を追加
    const countersContainer = document.getElementById('counters');
    countersData.forEach(function(counter) {
      countersContainer.appendChild(createCounter(counter));
    });
  </script>
</body>
</html>
